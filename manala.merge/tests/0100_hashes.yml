---

- name: "{{ test }}"
  hosts: all
  gather_facts: false
  vars:
    foo: bar
    bar:
      - bar_1
    baz:
      1: "{{ 'baz_1' }}"
    hash_1_1:
      foo: foo
      bar:
        - bar_2
    hash_1_2:
      bar: "{{ ['bar_3'] }}"
    hash_2_1:
      qux: qux
    manala_merge_hashes:
      - hashes:
          - hash_1_1
          - hash_1_2
          - baz:
              2: baz_2
      - hashes:
          - hash_2_(\w*)
  roles:
    - manala.merge
  post_tasks:
    - assert:
        that:
          - foo == 'foo'
          - bar == ['bar_1', 'bar_2', 'bar_3']
          - "baz == {1: 'baz_1', 2: 'baz_2'}"
          - qux == 'qux'
